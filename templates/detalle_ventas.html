{% extends "base.html" %}
{% block title %}{{ t("Empresas que buscan productos o servicios", "Companies requesting products or services", "å°‹æ‰¾ç”¢å“æˆ–æœå‹™çš„å…¬å¸") }}{% endblock %}

{% block content %}
<div class="detalle-container">
  <div class="detalle-card">
    <div class="detalle-header">
      <h2>{{ t("Empresas que buscan productos o servicios", "Companies requesting products or services", "å°‹æ‰¾ç”¢å“æˆ–æœå‹™çš„å…¬å¸") }}</h2>
      <p class="sub-text">{{ t("Selecciona las solicitudes que deseas atender", "Select the requests you want to attend", "é¸æ“‡æ‚¨æƒ³éŸ¿æ‡‰çš„è«‹æ±‚") }}</p>
    </div>

    <form method="GET" class="search-form">
      <input type="text" name="q" placeholder="{{ t('Buscar empresa o producto...', 'Search company or product...', 'æœå°‹å…¬å¸æˆ–ç”¢å“...') }}" value="{{ query }}">
      <button type="submit" class="btn btn-primary">{{ t("Buscar", "Search", "æœå°‹") }}</button>
    </form>

    <form method="POST" action="{{ url_for('cart_add') }}">
      <ul class="detalle-lista">
        {% if data %}
          {% for c in data %}
            {% if c.items %}
              {% for item in c.items %}
                <li class="detalle-item">
                  <div class="item-info">
                    <h3>{{ c.empresa }}</h3>
                    {% if item.producto %}
                      <p><strong>{{ t("Producto:", "Product:", "ç”¢å“ï¼š") }}</strong> {{ item.producto }}</p>
                      {% if item.variedad %}<p><strong>{{ t("Variedad:", "Variety:", "å“ç¨®ï¼š") }}</strong> {{ item.variedad }}</p>{% endif %}
                      {% if item.cantidad %}<p><strong>{{ t("Cantidad:", "Quantity:", "æ•¸é‡ï¼š") }}</strong> {{ item.cantidad }}</p>{% endif %}
                      {% if item.origen %}<p><strong>{{ t("Origen:", "Origin:", "ä¾†æºï¼š") }}</strong> {{ item.origen }}</p>{% endif %}
                      {% if item.precio_caja %}
                        <p><strong>{{ t("Precio/Caja:", "Price/Box:", "æ¯ç®±åƒ¹æ ¼ï¼š") }}</strong> ${{ item.precio_caja }}</p>
                      {% endif %}
                    {% elif item.servicio %}
                      <p><strong>{{ t("Servicio:", "Service:", "æœå‹™ï¼š") }}</strong> {{ item.servicio }}</p>
                    {% endif %}
                  </div>

                  <div class="item-actions">
                    <input type="hidden" name="item" value='{{ item | tojson }}'>
                    <button type="submit" class="btn btn-success">{{ t("Agregar al carrito ğŸ›’", "Add to cart ğŸ›’", "åŠ å…¥è³¼ç‰©è»Š ğŸ›’") }}</button>
                    <a href="{{ url_for('perfil', id=c.id) }}" class="btn btn-secondary">{{ t("Ver perfil", "View profile", "æŸ¥çœ‹è³‡æ–™") }}</a>
                  </div>
                </li>
              {% endfor %}
            {% endif %}
          {% endfor %}
        {% else %}
          <li class="no-results">{{ t("No hay solicitudes disponibles actualmente.", "No requests available at the moment.", "ç›®å‰æ²’æœ‰å¯ç”¨è«‹æ±‚ã€‚") }}</li>
        {% endif %}
      </ul>
    </form>

    <div class="detalle-footer">
      <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">{{ t("Volver al panel", "Back to Dashboard", "è¿”å›æ§åˆ¶å°") }}</a>
    </div>
  </div>
</div>
{% endblock %}
