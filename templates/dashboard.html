{% extends "base.html" %}
{% block content %}
<section class="dashboard-container fade-in">
  <h2 class="title-gradient">{{ t("Panel Principal","Main Dashboard","主面板") }}</h2>

  <div class="user-info glass-card mt-2">
    <p><strong>{{ t("Empresa:","Company:","公司：") }}</strong> {{ user.empresa }}</p>
    <p><strong>{{ t("Correo:","Email:","電子郵件：") }}</strong> {{ user.email }}</p>
    <p><strong>{{ t("Rol:","Role:","角色：") }}</strong> {{ user.rol }}</p>
    <p><strong>{{ t("Tipo de Cuenta:","Account Type:","帳戶類型：") }}</strong> {{ user.tipo }}</p>
  </div>

  <div class="dashboard-actions mt-3" style="display:flex;gap:12px;flex-wrap:wrap;">
    {% if user.tipo == "compras" %}
      <a href="{{ url_for('compras') }}" class="btn btn-primary">🛒 {{ t("Explorar Ofertas","Browse Offers","瀏覽商品") }}</a>
    {% elif user.tipo == "servicios" %}
      <a href="{{ url_for('servicios') }}" class="btn btn-secondary">🧰 {{ t("Ver Servicios","View Services","查看服務") }}</a>
    {% elif user.tipo in ("compraventa","mixto") %}
      <a href="{{ url_for('ventas') }}" class="btn btn-primary">💰 {{ t("Ver Demandas","View Demands","查看需求") }}</a>
      <a href="{{ url_for('compras') }}" class="btn btn-secondary">🛒 {{ t("Explorar Ofertas","Browse Offers","瀏覽商品") }}</a>
      <a href="{{ url_for('servicios') }}" class="btn btn-secondary">🧰 {{ t("Explorar Servicios","Browse Services","探索服務") }}</a>
    {% endif %}
  </div>

  {% if publicaciones %}
    <div class="glass-card mt-2">
      <h3>{{ t("Sugerencias para ti","Suggestions for you","為你推薦") }}</h3>
      <ul class="detalle-list">
        {% for p in publicaciones %}
        <li class="detalle-card">
          <h4>{{ p.empresa }}</h4>
          <p><strong>{{ t("Tipo","Type","類型") }}:</strong> {{ p.tipo }}</p>
          <p><strong>{{ t("Rol","Role","角色") }}:</strong> {{ p.rol }}</p>
          {% if p.producto %}<p><strong>{{ t("Producto","Product","產品") }}:</strong> {{ p.producto }}</p>{% endif %}
          {% if p.precio %}<p><strong>{{ t("Precio","Price","價格") }}:</strong> {{ p.precio }}</p>{% endif %}
          <div style="display:flex;gap:8px;margin-top:8px;flex-wrap:wrap;">
            <a href="{{ url_for('carrito_agregar', pub_id=p.id) }}" class="btn btn-secondary">🛍️ {{ t("Agregar al carrito","Add to Cart","加入購物車") }}</a>
            <form method="post" action="{{ url_for('ocultar_publicacion', pub_id=p.id) }}">
              <button type="submit" class="btn btn-secondary">🙈 {{ t("Eliminar de mi vista","Hide from my view","從我的視圖隱藏") }}</button>
            </form>
          </div>
        </li>
        {% endfor %}
      </ul>

      <form method="post" action="{{ url_for('restablecer_ocultos') }}" class="mt-2">
        <button type="submit" class="btn btn-warning">♻️ {{ t("Restablecer ocultos","Restore hidden","恢復隱藏項目") }}</button>
      </form>
    </div>
  {% else %}
    <div class="glass-card mt-2">
      <p class="no-results">{{ t("Aún no hay publicaciones para tu perfil。","There are no listings for your profile yet。","目前沒有適合你個人資料的貼文。") }}</p>
    </div>
  {% endif %}
</section>
{% endblock %}
