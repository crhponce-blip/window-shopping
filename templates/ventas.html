{% extends "base.html" %}
{% block content %}
<section class="detalle-container glass-card fade-in">
  <h2 class="title-gradient">ğŸ’° {{ t("Demandas Disponibles","Available Demands","å¯ç”¨çš„éœ€æ±‚") }}</h2>

  <form method="get" action="{{ url_for('ventas') }}" class="search-bar mt-3">
    <input type="text" name="q" placeholder="{{ t('Buscar por empresa o productoâ€¦','Search by company or productâ€¦','æŒ‰å…¬å¸æˆ–ç”¢å“æœå°‹â€¦') }}"
           value="{{ request.args.get('q','') }}">
    <button type="submit" class="btn btn-primary">{{ t("Buscar","Search","æœå°‹") }}</button>
  </form>

  {% if not demandas or demandas|length == 0 %}
    <p class="no-results">{{ t("No hay demandas disponibles para tu perfilã€‚","No demands available for your profileã€‚","ç›®å‰æ²’æœ‰å¯ç”¨çš„éœ€æ±‚ã€‚") }}</p>
  {% else %}
    <div class="detalle-list">
      {% for d in demandas %}
      <div class="detalle-card">
        <h3>{{ d.empresa }}</h3>
        <p><strong>{{ t("Rol:","Role:","è§’è‰²ï¼š") }}</strong> {{ d.rol }}</p>
        <p><strong>{{ t("DescripciÃ³n:","Description:","æè¿°ï¼š") }}</strong> {{ d.descripcion }}</p>

        {% if d.items %}
          <ul>
            {% for item in d.items if item.tipo == "demanda" %}
              <li>{{ item.nombre }} â€” {{ item.detalle }}</li>
            {% endfor %}
          </ul>
        {% endif %}

        <form method="post" action="{{ url_for('carrito_agregar', username=d.email) }}">
          <button type="submit" class="btn btn-secondary">ğŸ“¦ {{ t("Ofertar producto","Offer Product","æä¾›ç”¢å“") }}</button>
        </form>
      </div>
      {% endfor %}
    </div>
  {% endif %}
</section>
{% endblock %}
