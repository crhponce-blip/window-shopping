<!DOCTYPE html>
<html lang="{{ session.get('lang','es') }}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>🌐 Window Shopping</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body>
  <header class="navbar glass-card">
    <div class="logo">🪟 <b>WS</b></div>
    <nav>
      <a href="{{ url_for('home') }}">{{ t("Inicio","Home","主頁") }}</a>
      <a href="{{ url_for('compras') }}">{{ t("Empresas","Companies","公司") }}</a>
      <a href="{{ url_for('servicios') }}">{{ t("Servicios","Services","服務") }}</a>
      <a href="{{ url_for('carrito') }}">{{ t("Carrito","Cart","購物車") }}</a>

      {% if 'user' in session %}
        <a href="{{ url_for('dashboard') }}">{{ t("Panel de Usuario","User Dashboard","用戶主頁") }}</a>
        <a href="{{ url_for('perfil') }}">{{ t("Perfil","Profile","個人資料") }}</a>
        <a href="{{ url_for('logout') }}">{{ t("Salir","Logout","登出") }}</a>
      {% else %}
        <a href="{{ url_for('login') }}">{{ t("Iniciar sesión","Login","登入") }}</a>
        <a href="{{ url_for('register_router') }}">{{ t("Registrarse","Register","註冊") }}</a>
      {% endif %}
    </nav>

    <form method="post" action="{{ url_for('set_lang') }}" class="lang-form">
      <select name="lang" onchange="this.form.submit()">
        <option value="es" {% if session.get('lang','es')=='es' %}selected{% endif %}>🇨🇱 ES</option>
        <option value="en" {% if session.get('lang')=='en' %}selected{% endif %}>🇺🇸 EN</option>
        <option value="zh" {% if session.get('lang')=='zh' %}selected{% endif %}>🇨🇳 中文</option>
      </select>
    </form>
  </header>

  <main class="main-content">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="flash-container">
          {% for category, msg in messages %}
            <div class="flash {{ category }}">{{ msg }}</div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}
    {% block content %}{% endblock %}
  </main>

  <footer class="footer glass-card">
    <p>© 2025 Window Shopping — {{ t("Conectamos productores chilenos con compradores internacionales","Connecting Chilean producers with international buyers","連接智利生產商與國際買家") }}</p>
  </footer>
</body>
</html>
