{% extends "base.html" %}
{% block title %}{{ t("Ofertas disponibles","Available Offers","å¯ä¾›æ‡‰å•†å“") }}{% endblock %}
{% block content %}
<div class="detalle-container" style="max-width:980px;margin:26px auto">
  <h2>{{ t("Ofertas de productos disponibles","Available Product Offers","å¯è³¼è²·å•†å“æ¸…å–®") }}</h2>
  <form method="GET" style="display:flex;gap:8px;margin:10px 0">
    <input type="text" name="q" placeholder="{{ t('Buscar producto o empresa...','Search product or company...','æœå°‹ç”¢å“æˆ–å…¬å¸...') }}" value="{{ query }}">
    <button class="btn btn-secondary">{{ t("Buscar","Search","æœå°‹") }}</button>
  </form>

  <ul style="display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:12px;list-style:none;padding:0">
    {% for c in data %}
      {% for item in c.items if item.tipo in ['oferta','producto'] %}
      <li style="background:rgba(255,255,255,.08);padding:14px;border-radius:10px;">
        <h3 style="margin:0 0 6px">{{ c.empresa }}</h3>
        <p><b>{{ t("Producto:","Product:","ç”¢å“ï¼š") }}</b> {{ item.producto }}</p>
        {% if item.variedad %}<p><b>{{ t("Variedad:","Variety:","å“ç¨®ï¼š") }}</b> {{ item.variedad }}</p>{% endif %}
        {% if item.cantidad %}<p><b>{{ t("Cantidad:","Quantity:","æ•¸é‡ï¼š") }}</b> {{ item.cantidad }}</p>{% endif %}
        {% if item.origen %}<p><b>{{ t("Origen:","Origin:","ä¾†æºï¼š") }}</b> {{ item.origen }}</p>{% endif %}
        {% if item.precio_caja %}<p><b>{{ t("Precio/Caja:","Price/Box:","æ¯ç®±åƒ¹æ ¼ï¼š") }}</b> {{ item.precio_caja }}</p>{% endif %}
        <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:8px">
          <form method="post" action="{{ url_for('cart_add') }}">
            <input type="hidden" name="username" value="{{ c.username }}">
            <input type="hidden" name="tipo" value="compras">
            <button class="btn btn-success">{{ t("Agregar al carrito ğŸ›’","Add to cart ğŸ›’","åŠ å…¥è³¼ç‰©è»Š ğŸ›’") }}</button>
          </form>
          <a class="btn btn-secondary" href="{{ url_for('cliente_detalle', username=c.username) }}">{{ t("Ver perfil","View profile","æŸ¥çœ‹è³‡æ–™") }}</a>
        </div>
      </li>
      {% endfor %}
    {% else %}
      <li>{{ t("No hay ofertas disponibles actualmente.","No offers available at the moment.","ç›®å‰æ²’æœ‰å¯ç”¨çš„å•†å“ä¾›æ‡‰ã€‚") }}</li>
    {% endfor %}
  </ul>
</div>
{% endblock %}
