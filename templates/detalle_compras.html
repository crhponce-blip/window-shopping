{% extends "base.html" %}
{% block content %}
<section class="detalle-container glass-card fade-in">
  <h2>ğŸ›’ {{ t("Ofertas disponibles", "Available Offers", "å¯ç”¨çš„å ±åƒ¹") }}</h2>

  <form method="get" action="{{ url_for('compras') }}" class="search-bar mt-3">
    <input type="text" name="q" placeholder="{{ t('Buscar por empresa o descripciÃ³n...', 'Search by company or description...', 'æŒ‰å…¬å¸æˆ–æè¿°æœå°‹...') }}" value="{{ request.args.get('q', '') }}">
    <button type="submit" class="btn">{{ t("Buscar", "Search", "æœå°‹") }}</button>
  </form>

  {% if not data %}
    <p class="no-results">{{ t("No hay ofertas disponibles para tu perfil.", "No offers available for your profile.", "ç›®å‰æ²’æœ‰å¯ç”¨çš„å ±åƒ¹ã€‚") }}</p>
  {% else %}
    <div class="detalle-list">
      {% for empresa in data %}
        <div class="detalle-card">
          <h3>{{ empresa.empresa }}</h3>
          <p><strong>{{ t("Rol:", "Role:", "è§’è‰²ï¼š") }}</strong> {{ empresa.rol }}</p>
          <p><strong>{{ t("DescripciÃ³n:", "Description:", "æè¿°ï¼š") }}</strong> {{ empresa.descripcion }}</p>

          {% if empresa.items %}
            <ul>
              {% for item in empresa.items %}
                {% if item.tipo == "oferta" %}
                  <li>{{ item.nombre }} - {{ item.detalle }}</li>
                {% endif %}
              {% endfor %}
            </ul>
          {% endif %}

          <form method="post" action="{{ url_for('agregar_carrito', username=empresa.username) }}">
            <button type="submit" class="btn secondary">ğŸ›ï¸ {{ t("Agregar al carrito", "Add to Cart", "åŠ å…¥è³¼ç‰©è»Š") }}</button>
          </form>
        </div>
      {% endfor %}
    </div>
  {% endif %}
</section>
{% endblock %}
