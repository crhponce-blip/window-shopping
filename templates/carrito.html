{% extends "base.html" %}
{% block title %}{{ t("Mi Carrito", "My Cart", "æˆ‘çš„è³¼ç‰©è»Š") }}{% endblock %}

{% block content %}
<div class="carrito-container">
  <div class="carrito-card">
    <h2 class="carrito-titulo">{{ t("ğŸ›’ Mi Carrito de Compras", "ğŸ›’ My Shopping Cart", "ğŸ›’ æˆ‘çš„è³¼ç‰©è»Š") }}</h2>

    {% if cart and cart|length > 0 %}
      <table class="carrito-tabla">
        <thead>
          <tr>
            <th>{{ t("Empresa", "Company", "å…¬å¸") }}</th>
            <th>{{ t("Tipo", "Type", "é¡åˆ¥") }}</th>
            <th>{{ t("Detalle", "Detail", "è©³ç´°å…§å®¹") }}</th>
            <th>{{ t("Precio", "Price", "åƒ¹æ ¼") }}</th>
            <th>{{ t("AcciÃ³n", "Action", "æ“ä½œ") }}</th>
          </tr>
        </thead>
        <tbody>
          {% for i, item in enumerate(cart) %}
          <tr>
            <td>{{ item.get("empresa", "â€”") }}</td>
            <td>
              {% if item.tipo == "servicio" %}
                {{ t("Servicio", "Service", "æœå‹™") }}
              {% else %}
                {{ t("Producto", "Product", "ç”¢å“") }}
              {% endif %}
            </td>
            <td>
              {% if item.tipo == "servicio" %}
                {{ item.servicio }}{% if item.ubicacion %} - {{ item.ubicacion }}{% endif %}
              {% else %}
                {{ item.producto }}{% if item.variedad %} ({{ item.variedad }}){% endif %}{% if item.origen %} - {{ item.origen }}{% endif %}
              {% endif %}
            </td>
            <td>
              {% if item.precio_caja %}
                ${{ item.precio_caja }}
              {% elif item.precio_kilo %}
                ${{ item.precio_kilo }}
              {% else %}
                â€”
              {% endif %}
            </td>
            <td>
              <form method="POST" action="{{ url_for('cart_remove', index=i) }}">
                <button type="submit" class="btn btn-secondary btn-sm">
                  {{ t("Eliminar", "Remove", "åˆªé™¤") }}
                </button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>

      <div class="carrito-actions">
        <form method="POST" action="{{ url_for('cart_clear') }}">
          <button type="submit" class="btn btn-danger">{{ t("Vaciar carrito ğŸ—‘ï¸", "Clear cart ğŸ—‘ï¸", "æ¸…ç©ºè³¼ç‰©è»Š ğŸ—‘ï¸") }}</button>
        </form>

        <form method="POST" action="{{ url_for('checkout') }}">
          <button type="submit" class="btn btn-success">{{ t("Finalizar compra âœ…", "Checkout âœ…", "å®Œæˆè³¼è²· âœ…") }}</button>
        </form>
      </div>

    {% else %}
      <div class="carrito-vacio">
        <h3>{{ t("Tu carrito estÃ¡ vacÃ­o ğŸ›’", "Your cart is empty ğŸ›’", "è³¼ç‰©è»Šæ˜¯ç©ºçš„ ğŸ›’") }}</h3>
        <p>{{ t("Agrega productos o servicios para comenzar tu compra.", "Add products or services to start shopping.", "æ–°å¢å•†å“æˆ–æœå‹™ä»¥é–‹å§‹è³¼ç‰©ã€‚") }}</p>
        <a href="{{ url_for('dashboard') }}" class="btn btn-primary">{{ t("Volver al inicio", "Back to Home", "è¿”å›é¦–é ") }}</a>
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}
