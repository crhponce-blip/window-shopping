{% extends "base.html" %}
{% block title %}{{ t("Perfil de Usuario", "User Profile", "用戶資料") }}{% endblock %}

{% block content %}
<div class="perfil-container">
  <div class="perfil-card">
    <div class="perfil-avatar">
      <img src="{{ perfil.imagen or url_for('static', filename='img/default_user.png') }}" alt="avatar">
    </div>
    <h2 class="perfil-nombre">{{ perfil.nombre }}</h2>
    <p class="perfil-rol">{{ t("Rol", "Role", "角色") }}: <strong>{{ perfil.rol }}</strong></p>

    <div class="perfil-info">
      <p><strong>{{ t("Correo", "Email", "電子郵件") }}:</strong> {{ perfil.email }}</p>
      {% if perfil.telefono %}
      <p><strong>{{ t("Teléfono", "Phone", "電話") }}:</strong> {{ perfil.telefono }}</p>
      {% endif %}
      {% if perfil.empresa %}
      <p><strong>{{ t("Empresa", "Company", "公司") }}:</strong> {{ perfil.empresa }}</p>
      {% endif %}
    </div>

    <hr class="divider">

    <div class="perfil-actions">
      <form method="POST" action="{{ url_for('enviar_mensaje', id=perfil.id) }}">
        <textarea name="mensaje" class="mensaje-input" placeholder="{{ t('Escribe tu mensaje...', 'Write your message...', '輸入您的訊息...') }}" required></textarea>
        <button type="submit" class="btn btn-primary">
          {{ t("Enviar Mensaje", "Send Message", "發送訊息") }}
        </button>
      </form>
    </div>

    {% if mensaje_enviado %}
      <div class="alert success">
        {{ t("Mensaje enviado correctamente ✅", "Message sent successfully ✅", "訊息已成功發送 ✅") }}
      </div>
    {% elif cooldown_activo %}
      <div class="alert warning">
        {{ t("Solo puedes enviar un mensaje cada 3 días ⏳", "You can only send a message every 3 days ⏳", "您每3天只能發送一次訊息 ⏳") }}
      </div>
    {% endif %}

    <a href="{{ url_for('home') }}" class="btn btn-secondary volver">
      {{ t("Volver al Inicio", "Return Home", "返回首頁") }}
    </a>
  </div>
</div>
{% endblock %}
